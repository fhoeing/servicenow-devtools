<?xml version="1.0" encoding="UTF-8"?><record_update table="scan_table_check">
    <scan_table_check action="DELETE">
        <active>true</active>
        <advanced>true</advanced>
        <category>code_sanity</category>
        <conditions/>
        <description>A Flow, Subflow or Flow Action should never depend on specific data records. This follows the doctrine that no code should ever depend on data.</description>
        <documentation_url/>
        <finding_type>scan_finding</finding_type>
        <name>CodeSanity - Flow depends on data</name>
        <priority>1</priority>
        <resolution_details>Modify the Flow, Subflow or Flow Action logic so that it does not depend on specific data records. If specific data records (users, groups, departments, etc.) are relevant for the flow logic, these must be loaded dynamically or configured explicitly - e.g. using System Properties.</resolution_details>
        <run_condition/>
        <score_max>100</score_max>
        <score_min>0</score_min>
        <score_scale>1</score_scale>
        <script><![CDATA[(function (engine) {

	if (x_snc_codesanity.IsCheckApplicableToRecord())
	{
		var strValue = GetStringValue(current.value);
		var aSysIds = x_snc_devtools.GetSysIdsFromString(strValue);
		var bDataRecordFound = false;
		for (var nSysId = 0; nSysId < aSysIds.length; nSysId++)
		{
			var strSysId = aSysIds[nSysId];
			if (x_snc_devtools.IsDataRecord(strSysId) == true)
			{
				bDataRecordFound = true;
			}
		}
		if (bDataRecordFound == true)
		{
			engine.finding.increment();
		}
	}

})(engine);]]></script>
        <short_description>Flows must not depend on data</short_description>
        <sys_class_name>scan_table_check</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-26 12:14:11</sys_created_on>
        <sys_id>507993de3ba7661062bf612c95e45a95</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>CodeSanity - Flow depends on data</sys_name>
        <sys_package display_value="DevTools WORK IN PROGRESS" source="x_snc_devtools">d689f6901bd38450a89720a8ec4bcbfd</sys_package>
        <sys_policy/>
        <sys_scope display_value="DevTools WORK IN PROGRESS">d689f6901bd38450a89720a8ec4bcbfd</sys_scope>
        <sys_update_name>scan_table_check_507993de3ba7661062bf612c95e45a95</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-26 12:14:11</sys_updated_on>
        <table>sys_variable_value</table>
        <use_manifest>false</use_manifest>
    </scan_table_check>
    <sys_translated_text action="DELETE" query="documentkey=507993de3ba7661062bf612c95e45a95"/>
    <sys_es_latest_script action="DELETE">
        <id>507993de3ba7661062bf612c95e45a95</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-26 12:14:10</sys_created_on>
        <sys_id>a64b9bde3ba7661062bf612c95e45a92</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-26 12:14:10</sys_updated_on>
        <table>scan_table_check</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="DevTools">d689f6901bd38450a89720a8ec4bcbfd</application>
        <file_path/>
        <instance_id>a8cbb5133b6b5e540fd412c5e4e45a1f</instance_id>
        <instance_name>wildyokohama</instance_name>
        <name>scan_table_check_507993de3ba7661062bf612c95e45a95</name>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="scan_table_check"&gt;&lt;scan_table_check action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;advanced&gt;true&lt;/advanced&gt;&lt;category&gt;code_sanity&lt;/category&gt;&lt;conditions/&gt;&lt;description&gt;A Flow, Subflow or Flow Action should never depend on specific data records. This follows the doctrine that no code should ever depend on data.&lt;/description&gt;&lt;documentation_url/&gt;&lt;finding_type&gt;scan_finding&lt;/finding_type&gt;&lt;name&gt;CodeSanity - Flow depends on data&lt;/name&gt;&lt;priority&gt;1&lt;/priority&gt;&lt;resolution_details&gt;Modify the Flow, Subflow or Flow Action logic so that it does not depend on specific data records. If specific data records (users, groups, departments, etc.) are relevant for the flow logic, these must be loaded dynamically or configured explicitly - e.g. using System Properties.&lt;/resolution_details&gt;&lt;run_condition/&gt;&lt;score_max&gt;100&lt;/score_max&gt;&lt;score_min&gt;0&lt;/score_min&gt;&lt;score_scale&gt;1&lt;/score_scale&gt;&lt;script&gt;&lt;![CDATA[(function (engine) {

	if (x_snc_codesanity.IsCheckApplicableToRecord())
	{
		var strValue = GetStringValue(current.value);
		var aSysIds = x_snc_devtools.GetSysIdsFromString(strValue);
		var bDataRecordFound = false;
		for (var nSysId = 0; nSysId &lt; aSysIds.length; nSysId++)
		{
			var strSysId = aSysIds[nSysId];
			if (x_snc_devtools.IsDataRecord(strSysId) == true)
			{
				bDataRecordFound = true;
			}
		}
		if (bDataRecordFound == true)
		{
			engine.finding.increment();
		}
	}

})(engine);]]&gt;&lt;/script&gt;&lt;short_description&gt;Flows must not depend on data&lt;/short_description&gt;&lt;sys_class_name&gt;scan_table_check&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-08-26 12:14:11&lt;/sys_created_on&gt;&lt;sys_id&gt;507993de3ba7661062bf612c95e45a95&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;CodeSanity - Flow depends on data&lt;/sys_name&gt;&lt;sys_package display_value="DevTools WORK IN PROGRESS" source="x_snc_devtools"&gt;d689f6901bd38450a89720a8ec4bcbfd&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="DevTools WORK IN PROGRESS"&gt;d689f6901bd38450a89720a8ec4bcbfd&lt;/sys_scope&gt;&lt;sys_update_name&gt;scan_table_check_507993de3ba7661062bf612c95e45a95&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-08-26 12:14:11&lt;/sys_updated_on&gt;&lt;table&gt;sys_variable_value&lt;/table&gt;&lt;use_manifest&gt;false&lt;/use_manifest&gt;&lt;/scan_table_check&gt;&lt;sys_translated_text action="delete_multiple" query="documentkey=507993de3ba7661062bf612c95e45a95"/&gt;&lt;sys_es_latest_script action="INSERT_OR_UPDATE"&gt;&lt;id&gt;507993de3ba7661062bf612c95e45a95&lt;/id&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2025-08-26 12:14:10&lt;/sys_created_on&gt;&lt;sys_id&gt;a64b9bde3ba7661062bf612c95e45a92&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2025-08-26 12:14:10&lt;/sys_updated_on&gt;&lt;table&gt;scan_table_check&lt;/table&gt;&lt;use_es_latest&gt;true&lt;/use_es_latest&gt;&lt;/sys_es_latest_script&gt;&lt;/record_update&gt;</payload>
        <payload_hash>-1367955814</payload_hash>
        <record_name>CodeSanity - Flow depends on data</record_name>
        <reverted_from/>
        <source>d7835e053b0b621062bf612c95e45a14</source>
        <source_table>sys_update_set</source_table>
        <state>previous</state>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-26 12:14:11</sys_created_on>
        <sys_id>764b57523be7661062bf612c95e45af0</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_recorded_at>198e64cd4ac0000001</sys_recorded_at>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-26 12:14:11</sys_updated_on>
        <type>Table Check</type>
        <update_guid>3a4b57526be766109f050189041275ef</update_guid>
        <update_guid_history>3a4b57526be766109f050189041275ef:-1367955814</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete display_value="CodeSanity - Flow depends on data">94778cea3bab661062bf612c95e45a3c</sys_audit_delete>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-26 15:27:05</sys_created_on>
        <sys_db_object display_value="" name="scan_table_check">scan_table_check</sys_db_object>
        <sys_id>01b7be0309c745678006616ada5ad041</sys_id>
        <sys_metadata>507993de3ba7661062bf612c95e45a95</sys_metadata>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>CodeSanity - Flow depends on data</sys_name>
        <sys_package display_value="DevTools" source="x_snc_devtools">d689f6901bd38450a89720a8ec4bcbfd</sys_package>
        <sys_parent/>
        <sys_policy/>
        <sys_scope display_value="DevTools">d689f6901bd38450a89720a8ec4bcbfd</sys_scope>
        <sys_scope_delete display_value="">00add56a207e4bf3800cdb72bd156af9</sys_scope_delete>
        <sys_update_name>scan_table_check_507993de3ba7661062bf612c95e45a95</sys_update_name>
        <sys_update_version display_value="scan_table_check_507993de3ba7661062bf612c95e45a95">764b57523be7661062bf612c95e45af0</sys_update_version>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-26 15:27:05</sys_updated_on>
    </sys_metadata_delete>
</record_update>
